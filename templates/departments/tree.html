{% load mptt_tags %}
<!DOCTYPE html>
<html>
<head>
    <title>Departments</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
<div class="container mt-5">
    <h2>Departments Tree</h2>
    <ul class="list-group">
        {% for department in departments %}
            <li class="list-group-item">
                <a href="#"
                   class="toggle"
                   data-bs-toggle="collapse"
                   data-bs-target="#department-{{ department.id }}"
                   aria-expanded="false" aria-controls="department-{{ department.id }}">
                    {{ department.name }} (click to expand)
                </a>
                <br>
                {% include "departments/includes/employees.html" %}
                {% include "departments/includes/tree_element.html" %}
            </li>
        {% endfor %}
    </ul>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const collapses = document.querySelectorAll('.collapse');
        collapses.forEach(function (collapse) {
            const bsCollapse = new bootstrap.Collapse(collapse, {
                toggle: false
            });
            bsCollapse.hide();
        });
    });
</script>
</body>
</html>
